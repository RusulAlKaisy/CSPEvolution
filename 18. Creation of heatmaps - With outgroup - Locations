#Now let us create heatmaps for the datasets without an outgroup

#Firsdataset - NO outgroup

#H2 class model
H2_classmodelFirstDataSet_NOOutgroup<-read.table("FirstDataSet_LocationsNOOutGroupH2GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H2_classmodelFirstDataSet_NOOutgroup_matrix<-as.matrix(H2_classmodelFirstDataSet_NOOutgroup)
H2_classmodelFirstDataSet_NOOoutgroup_plot<-heatmap(H2_classmodelFirstDataSet_withoutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FirstDataSet_NOoutgroup_Figure 1F",ylab="sites",main="Heatmap_H2_locationsNOgroup")

#H3 class model
H3_classmodelFirstDataSet_NOOutgroup<-read.table("FirstDataSet_LocationsNOOutGroupH3GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H3_classmodelFirstDataSet_NOOutgroup_matrix<-as.matrix(H3_classmodelFirstDataSet_NOOutgroup)
H3_classmodelFirstDataSet_NOOoutgroup_plot<-heatmap(H3_classmodelFirstDataSet_withoutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FirstDataSet_NOoutgroup_Figure 4F",ylab="sites",main="Heatmap_H3_locationsNOgroup")

#H4 class model 
H4_classmodelFirstDataSet_NOOutgroup<-read.table("FirstDataSet_LocationsNOOutGroupH4GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H4_classmodelFirstDataSet_NOOutgroup_matrix<-as.matrix(H4_classmodelFirstDataSet_NOOutgroup)
H4_classmodelFirstDataSet_NOOoutgroup_plot<-heatmap(H4_classmodelFirstDataSet_withoutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FirstDataSet_NOoutgroup_Figure 2F",ylab="sites",main="Heatmap_H4_locationsNOgroup")

#H5 class model 
H5_classmodelFirstDataSet_NOOutgroup<-read.table("FirstDataSet_LocationsNOOutGroupH5GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H5_classmodelFirstDataSet_NOOutgroup_matrix<-as.matrix(H5_classmodelFirstDataSet_NOOutgroup)
H5_classmodelFirstDataSet_NOOoutgroup_plot<-heatmap(H5_classmodelFirstDataSet_withoutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FirstDataSet_NOoutgroup_Figure 5F",ylab="sites",main="Heatmap_H5_locationsNOgroup")


#H6 class model 
H6_classmodelFirstDataSet_NOOutgroup<-read.table("FirstDataSet_LocationsNOOutGroupH6GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H6_classmodelFirstDataSet_NOOutgroup_matrix<-as.matrix(H6_classmodelFirstDataSet_NOOutgroup)
H6_classmodelFirstDataSet_NOOoutgroup_plot<-heatmap(H6_classmodelFirstDataSet_withoutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FirstDataSet_NOoutgroup_Figure 3F",ylab="sites",main="Heatmap_H6_locationsNOgroup")

#Let's do the second dataset with no outgroup
H2_classmodelSecondDataSet_NoOutgroup<-read.table("SecondDataSet_LocationsNOOutGroupH2GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H2_classmodelSecondDataSet_NOOutgroup_matrix<-as.matrix(H2_classmodelSecondDataSet_NoOutgroup)
H2_classmodelSecondDataSet_NOOoutgroup_plot<-heatmap(H2_classmodelSecondDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - SecondDataSet_NOOutgroup_Figure 1G",ylab="sites",main="Heatmap_H2_locationsNOgroup")

#H3 class model
H3_classmodelSecondDataSet_NoOutgroup<-read.table("SecondDataSet_LocationsNOOutGroupH3GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H3_classmodelSecondDataSet_NOOutgroup_matrix<-as.matrix(H3_classmodelSecondDataSet_NoOutgroup)
H3_classmodelSecondDataSet_NOOoutgroup_plot<-heatmap(H3_classmodelSecondDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - SecondDataSet_NOOutgroup_Figure 4G",ylab="sites",main="Heatmap_H3_locationsNOgroup")

#H4 class model
H4_classmodelSecondDataSet_NoOutgroup<-read.table("SecondDataSet_LocationsNOOutGroupH4GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H4_classmodelSecondDataSet_NOOutgroup_matrix<-as.matrix(H4_classmodelSecondDataSet_NoOutgroup)
H4_classmodelSecondDataSet_NOOoutgroup_plot<-heatmap(H4_classmodelSecondDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - SecondDataSet_NOOutgroup_Figure 2G",ylab="sites",main="Heatmap_H4_locationsNOgroup")

#H5 class model
H5_classmodelSecondDataSet_NoOutgroup<-read.table("SecondDataSet_LocationsNOOutGroupH5GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H5_classmodelSecondDataSet_NOOutgroup_matrix<-as.matrix(H5_classmodelSecondDataSet_NoOutgroup)
H5_classmodelSecondDataSet_NOOoutgroup_plot<-heatmap(H5_classmodelSecondDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - SecondDataSet_NOOutgroup_Figure 5G",ylab="sites",main="Heatmap_H5_locationsNOgroup")


#H6 class model
H6_classmodelSecondDataSet_NoOutgroup<-read.table("SecondDataSet_LocationsNOOutGroupH6GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H6_classmodelSecondDataSet_NOOutgroup_matrix<-as.matrix(H6_classmodelSecondDataSet_NoOutgroup)
H6_classmodelSecondDataSet_NOOoutgroup_plot<-heatmap(H6_classmodelSecondDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - SecondDataSet_NOOutgroup_Figure 3G",ylab="sites",main="Heatmap_H6_locationsNOgroup")



#Let's do the third dataset with no outgroup

#H2 class model
H2_classmodelThirdDataSet_NoOutgroup<-read.table("ThirdDataSet_LocationsNOOutGroupH2GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H2_classmodelThirdDataSet_NOOutgroup_matrix<-as.matrix(H2_classmodelThirdDataSet_NoOutgroup)
H2_classmodelThirdDataSet_NOOoutgroup_plot<-heatmap(H2_classmodelThirdDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - ThirdDataSet_NOOutgroup_Figure 1H",ylab="sites",main="Heatmap_H2_locationsNOgroup")

#H3 class model
H3_classmodelThirdDataSet_NoOutgroup<-read.table("ThirdDataSet_LocationsNOOutGroupH3GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H3_classmodelThirdDataSet_NOOutgroup_matrix<-as.matrix(H3_classmodelThirdDataSet_NoOutgroup)
H3_classmodelThirdDataSet_NOOoutgroup_plot<-heatmap(H3_classmodelThirdDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - ThirdDataSet_NOOutgroup_Figure 4H",ylab="sites",main="Heatmap_H3_locationsNOgroup")


#H4 class model
H4_classmodelThirdDataSet_NoOutgroup<-read.table("ThirdDataSet_LocationsNOOutGroupH4GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H4_classmodelThirdDataSet_NOOutgroup_matrix<-as.matrix(H4_classmodelThirdDataSet_NoOutgroup)
H4_classmodelThirdDataSet_NOOoutgroup_plot<-heatmap(H4_classmodelThirdDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - ThirdDataSet_NOOutgroup_Figure 2H",ylab="sites",main="Heatmap_H4_locationsNOgroup")

#H5 class model
H5_classmodelThirdDataSet_NoOutgroup<-read.table("ThirdDataSet_LocationsNOOutGroupH5GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H5_classmodelThirdDataSet_NOOutgroup_matrix<-as.matrix(H5_classmodelThirdDataSet_NoOutgroup)
H5_classmodelThirdDataSet_NOOoutgroup_plot<-heatmap(H5_classmodelThirdDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - ThirdDataSet_NOOutgroup_Figure 5H",ylab="sites",main="Heatmap_H5_locationsNOgroup")

#H6 class model 
H6_classmodelThirdDataSet_NoOutgroup<-read.table("ThirdDataSet_LocationsNOOutGroupH6GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H6_classmodelThirdDataSet_NOOutgroup_matrix<-as.matrix(H6_classmodelThirdDataSet_NoOutgroup)
H6_classmodelThirdDataSet_NOOoutgroup_plot<-heatmap(H6_classmodelThirdDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - ThirdDataSet_NOOutgroup_Figure 3H",ylab="sites",main="Heatmap_H6_locationsNOgroup")

#Let's do the fourth dataset with no outgroup

#H2 class model
H2_classmodelFourthDataSet_NoOutgroup<-read.table("FourthDataSet_LocationsNOOutGroupH2GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H2_classmodelFourthDataSet_NOOutgroup_matrix<-as.matrix(H2_classmodelFourthDataSet_NoOutgroup)
H2_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H2_classmodelFourthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FourthDataSet_NOOutgroup_Figure 1I",ylab="sites",main="Heatmap_H2_locationsNOgroup")


#H3 class model
H3_classmodelFourthDataSet_NoOutgroup<-read.table("FourthDataSet_LocationsNOOutGroupH3GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H3_classmodelFourthDataSet_NOOutgroup_matrix<-as.matrix(H3_classmodelFourthDataSet_NoOutgroup)
H3_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H3_classmodelFourthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FourthDataSet_NOOutgroup_Figure 4I",ylab="sites",main="Heatmap_H3_locationsNOgroup")

#H4 class model
H4_classmodelFourthDataSet_NoOutgroup<-read.table("FourthDataSet_LocationsNOOutGroupH4GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H4_classmodelFourthDataSet_NOOutgroup_matrix<-as.matrix(H4_classmodelFourthDataSet_NoOutgroup)
H4_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H4_classmodelFourthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FourthDataSet_NOOutgroup_Figure 2I",ylab="sites",main="Heatmap_H4_locationsNOgroup")

#H5 class model
H5_classmodelFourthDataSet_NoOutgroup<-read.table("FourthDataSet_LocationsNOOutGroupH5GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H5_classmodelFourthDataSet_NOOutgroup_matrix<-as.matrix(H5_classmodelFourthDataSet_NoOutgroup)
H5_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H5_classmodelFourthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FourthDataSet_NOOutgroup_Figure 5I",ylab="sites",main="Heatmap_H5_locationsNOgroup")

#H6 class model
H6_classmodelFourthDataSet_NoOutgroup<-read.table("FourthDataSet_LocationsNOOutGroupH6GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H6_classmodelFourthDataSet_NOOutgroup_matrix<-as.matrix(H6_classmodelFourthDataSet_NoOutgroup)
H6_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H6_classmodelFourthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FourthDataSet_NOOutgroup_Figure 3I",ylab="sites",main="Heatmap_H6_locationsNOgroup")


#Let's do the fifth dataset 


#H2 class model
H2_classmodelFifthDataSet_NoOutgroup<-read.table("FifthDataSet_LocationsNOOutGroupH2GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H2_classmodelFifthDataSet_NOOutgroup_matrix<-as.matrix(H2_classmodelFifthDataSet_NoOutgroup)
H2_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H2_classmodelFifthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FifthDataSet_NOOutgroup_Figure 1J",ylab="sites",main="Heatmap_H2_locationsNOgroup")

#H3 class model
H3_classmodelFifthDataSet_NoOutgroup<-read.table("FifthDataSet_LocationsNOOutGroupH3GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H3_classmodelFifthDataSet_NOOutgroup_matrix<-as.matrix(H3_classmodelFifthDataSet_NoOutgroup)
H3_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H3_classmodelFifthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FifthDataSet_NOOutgroup_Figure 4J",ylab="sites",main="Heatmap_H3_locationsNOgroup")

#H4 class model
H4_classmodelFifthDataSet_NoOutgroup<-read.table("FifthDataSet_LocationsNOOutGroupH4GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H4_classmodelFifthDataSet_NOOutgroup_matrix<-as.matrix(H4_classmodelFifthDataSet_NoOutgroup)
H4_classmodelFifthDataSet_NOOoutgroup_plot<-heatmap(H4_classmodelFifthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FifthDataSet_NOOutgroup_Figure 2J",ylab="sites",main="Heatmap_H4_locationsNOgroup")

#H5 class model
H5_classmodelFifthDataSet_NoOutgroup<-read.table("FifthDataSet_LocationsNOOutGroupH5GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H5_classmodelFifthDataSet_NOOutgroup_matrix<-as.matrix(H5_classmodelFifthDataSet_NoOutgroup)
H5_classmodelFourthDataSet_NOOoutgroup_plot<-heatmap(H5_classmodelFifthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FifthDataSet_NOOutgroup_Figure 5J",ylab="sites",main="Heatmap_H5_locationsNOgroup")

#H6 class model

H6_classmodelFifthDataSet_NoOutgroup<-read.table("FifthDataSet_LocationsNOOutGroupH6GHOST.fasta.siteprob",header=TRUE,row.names=1)
#Create a matrix
H6_classmodelFifthDataSet_NOOutgroup_matrix<-as.matrix(H6_classmodelFifthDataSet_NoOutgroup)
H6_classmodelFifthDataSet_NOOoutgroup_plot<-heatmap(H6_classmodelFifthDataSet_NOOutgroup_matrix,Rowv=NA,Colv=NA,scale="none",xlab="Categories - FifthDataSet_NOOutgroup_Figure 3J",ylab="sites",main="Heatmap_H6_locationsNOgroup")


#Heatmap for the figure
H2_classbinary<-H2_classmodellocations
H2_classbinary[which(H2_classbinary[,2]>0.5),2]<-1
H2_classbinary[which(H2_classbinary[,2]<0.5),2]<-0
H2_classbinary<-t(H2_classbinary)
heatmap(H2_classbinary,Rowv=NA,Colv=NA,scale="none",xlab="Categories",ylab="sites",main="heatmap_figure")
